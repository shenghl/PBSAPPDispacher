<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8"/>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
		<link rel="stylesheet" type="text/css" href="css/common.css"/>
		<script src="js/common.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/immersed.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/mui.min.js"></script>
		<title>Map Example</title>
	<script type="text/javascript">
		var em=null,map=null;
		// H5 plus事件处理
		function plusReady(){
			// 确保DOM解析完成
			if(!em||!window.plus||map){return};
			map = new plus.maps.Map("map");
			//高德坐标为 120.158582,30.280889
			//百度坐标为 120.226869,30.214203
			map.centerAndZoom( new plus.maps.Point(120.226869,30.214203),16);
			//添加Marker图标
			//createMarker();
			
			//用户点击地图显示经纬度
//			map.onclick = function( point ){
//				mui.alert( JSON.stringify(point) );
//			}
		}
		
		if(window.plus){
			plusReady();
		}else{
			document.addEventListener("plusready",plusReady,false);
		}
		
		// DOMContentloaded事件处理
		document.addEventListener("DOMContentLoaded",function(){
			em=document.getElementById("map");
			plusReady();
		},false);
		
		// 街道视图
//		function normalMap(){
//			map.setMapType( plus.maps.MapType.MAPTYPE_NORMAL );
//		}
		
		// 卫星视图
//		function stelliteMap(){
//			map.setMapType( plus.maps.MapType.MAPTYPE_SATELLITE );
//		}
		
		
		// 获取用户的当前位置信息
//		function getUserLocation(){
//			map.getUserLocation( function ( state, point ){
//				if( 0 == state ){
//					alert( JSON.stringify(point) );
//				}else{
//					alert( "Failed!" );
//				}
//			} );
//		}

		//定位到当前位置
		function userLocation(){
			map.showUserLocation(true);
			map.getUserLocation(function(state,pos){
				if(0==state){
					map.setCenter(pos);
				}
			});
		}
		
		//修改定位点图标
		function createMarker(){
				//高德地图坐标为(116.3406445236,39.9630878208), 百度地图坐标为(116.347292,39.968716
				var marker=new plus.maps.Marker(new plus.maps.Point(120.226869,30.214203));
				marker.setIcon("man.png");
				marker.setLabel("You Are Here");
				var bubble = new plus.maps.Bubble("PBS");
				marker.setBubble(bubble);
				map.addOverlay(marker);
			}
	</script>
	<style type="text/css">
		#map {
			width: 100%;
			position: fixed;
			top: 40px;
			bottom: 0px;
			line-height: 200px;
			text-align: center;
			background: #FFFFFF;
		}
		.ipos {
				background: no-repeat center center url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAsCAYAAAAn4+taAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABZ0RVh0Q3JlYXRpb24gVGltZQAwNC8wMS8xNExYUU4AAAAcdEVYdFNvZnR3YXJlAEFkb2JlIEZpcmV3b3JrcyBDUzbovLKMAAACTklEQVRoge2YO2gUURSGv7PjEkULO4UoFooIFgtzprAPWMiWKewSTadgYWEhBjHCloGUQtYHaGEjGAQtUmgnZO9YpsqC2NgYIwjRInMscoPrYkzhGTIs8zdnzoP578ewM/eumBmjoMZ+L8BLNUjVVINUTTVI1VSDVE0jA3KgjJuGEE6LyI2iKC6JyBkzWxORF8ADVV0rw1O891ohhCngPnDyL+1PZjabZdkTV1OcQUIIV4CHMf0JvAK+A0eANjAWe1dV9ZGbMY6/kTzPzwHzMV0VkZaqTgLTqjopIi1gNfbnQwhnvbzBEcTMbgFHgXURaRdFsRFCWAa+hhCWi6LYEJE2sB7nbnp5g+9b62KMIU3Tvoh0gQm2Fz0hIt00TftAADCztqO3K8h4jJsAZnZ+sDmQ/wAQkXEc5QnyJcZjACLybLApIk/j5YmheRd5gryLMev1elOqesfMrpvZczO7pqqzvV5vGmgNzbvIDUREXsbLRES6IYTbzWZzMcuyy0mSPA4h3BWRxR3PgXkff6/vSJ7nx83sPXBqoLwJFEACHByofxSRC2mafnYxx/GJxEW9GSofAg7zJwTAa08I8N80doG9HrHx++vvJlcQVV0xs6V/zZjZkqquePpCOdv4OWBrl96WiNwrwdMfJMuyHFjYpb2gqh+8PaG8g9Uc0B+q9WO9FJUCoqrfgBm2X73EOBPrpai0o66qvgU6Me3EvDSVctTdUZIknaIoxhqNRmfv6f+T+1F3vzQy/6LUIFVTDVI11SBVUw1SNdUgVdPIgPwCtt+2JPQRVicAAAAASUVORK5CYII=);
				background-size: 50px 44px;
			}	
		</style>
	</head>
	<body>
		<header id="header">
			<!--这个class="nvbt iback"关联js/common.css-->
			<div class="nvbt iback" onclick="back();"></div>
			<div class="nvtt">你的位置</div>
			<!--class="nvbt ipos"关联css/common.css-->
			<div class="nvbt ipos" onclick="userLocation();"></div>
		</header>
		<div id="map">地图加载中...</div>
	</body>
</html>